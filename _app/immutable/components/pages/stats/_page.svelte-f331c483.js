import{S as st,i as lt,s as ot,e as K,b as U,G as z,h as d,k as u,q as $,a as D,l as p,m,r as H,c as T,n as M,F as o,P as nt,u as I,w as rt,R as it,x as ct,y as dt,f as ht,t as ft,z as _t,H as Q,o as ut,T as W}from"../../../chunks/index-1918b0bc.js";import{d as C,f as Z,o as x}from"../../../chunks/stores-19686917.js";function tt(f,a,l){const t=f.slice();return t[5]=a[l],t}function et(f){let a,l,t,e,n,i,_,h,O,S,g,R,q,b,j,L,k,A,P,E,y=Object.values(f[0]),r=[];for(let s=0;s<y.length;s+=1)r[s]=at(tt(f,y,s));return{c(){a=u("div"),l=u("table"),t=u("thead"),e=u("tr"),n=u("th"),i=$("Name"),_=D(),h=u("th"),O=$("Artists"),S=D(),g=u("th"),R=$("Playlists"),q=D(),b=u("th"),j=$("Date"),L=D(),k=u("th"),A=$("Position"),P=D(),E=u("tbody");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){a=p(s,"DIV",{class:!0});var w=m(a);l=p(w,"TABLE",{class:!0});var c=m(l);t=p(c,"THEAD",{});var N=m(t);e=p(N,"TR",{});var v=m(e);n=p(v,"TH",{});var B=m(n);i=H(B,"Name"),B.forEach(d),_=T(v),h=p(v,"TH",{});var F=m(h);O=H(F,"Artists"),F.forEach(d),S=T(v),g=p(v,"TH",{});var G=m(g);R=H(G,"Playlists"),G.forEach(d),q=T(v),b=p(v,"TH",{});var X=m(b);j=H(X,"Date"),X.forEach(d),L=T(v),k=p(v,"TH",{});var Y=m(k);A=H(Y,"Position"),Y.forEach(d),v.forEach(d),N.forEach(d),P=T(c),E=p(c,"TBODY",{});var J=m(E);for(let V=0;V<r.length;V+=1)r[V].l(J);J.forEach(d),c.forEach(d),w.forEach(d),this.h()},h(){M(l,"class","table is-bordered is-striped is-narrow is-hoverable is-fullwidth"),M(a,"class","table-container")},m(s,w){U(s,a,w),o(a,l),o(l,t),o(t,e),o(e,n),o(n,i),o(e,_),o(e,h),o(h,O),o(e,S),o(e,g),o(g,R),o(e,q),o(e,b),o(b,j),o(e,L),o(e,k),o(k,A),o(l,P),o(l,E);for(let c=0;c<r.length;c+=1)r[c].m(E,null)},p(s,w){if(w&1){y=Object.values(s[0]);let c;for(c=0;c<y.length;c+=1){const N=tt(s,y,c);r[c]?r[c].p(N,w):(r[c]=at(N),r[c].c(),r[c].m(E,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=y.length}},d(s){s&&d(a),nt(r,s)}}}function at(f){let a,l,t=f[5].name+"",e,n,i,_=f[5].artists.join(", ")+"",h,O,S,g=f[5].playlists.join(`, 
`)+"",R,q,b,j=f[5].date.toLocaleDateString("en-US")+"",L,k,A,P=f[5].position+"",E,y;return{c(){a=u("tr"),l=u("td"),e=$(t),n=D(),i=u("td"),h=$(_),O=D(),S=u("td"),R=$(g),q=D(),b=u("td"),L=$(j),k=D(),A=u("td"),E=$(P),y=D()},l(r){a=p(r,"TR",{});var s=m(a);l=p(s,"TD",{});var w=m(l);e=H(w,t),w.forEach(d),n=T(s),i=p(s,"TD",{});var c=m(i);h=H(c,_),c.forEach(d),O=T(s),S=p(s,"TD",{});var N=m(S);R=H(N,g),N.forEach(d),q=T(s),b=p(s,"TD",{});var v=m(b);L=H(v,j),v.forEach(d),k=T(s),A=p(s,"TD",{});var B=m(A);E=H(B,P),B.forEach(d),y=T(s),s.forEach(d)},m(r,s){U(r,a,s),o(a,l),o(l,e),o(a,n),o(a,i),o(i,h),o(a,O),o(a,S),o(S,R),o(a,q),o(a,b),o(b,L),o(a,k),o(a,A),o(A,E),o(a,y)},p(r,s){s&1&&t!==(t=r[5].name+"")&&I(e,t),s&1&&_!==(_=r[5].artists.join(", ")+"")&&I(h,_),s&1&&g!==(g=r[5].playlists.join(`, 
`)+"")&&I(R,g),s&1&&j!==(j=r[5].date.toLocaleDateString("en-US")+"")&&I(L,j),s&1&&P!==(P=r[5].position+"")&&I(E,P)},d(r){r&&d(a)}}}function pt(f){let a=f[0]&&Object.keys(f[0]).length>0,l,t=a&&et(f);return{c(){t&&t.c(),l=K()},l(e){t&&t.l(e),l=K()},m(e,n){t&&t.m(e,n),U(e,l,n)},p(e,[n]){n&1&&(a=e[0]&&Object.keys(e[0]).length>0),a?t?t.p(e,n):(t=et(e),t.c(),t.m(l.parentNode,l)):t&&(t.d(1),t=null)},i:z,o:z,d(e){t&&t.d(e),e&&d(l)}}}function mt(f,a,l){let t={};const e=(n,i=new Date)=>{const _=new Date(i.getTime());return _.setDate(i.getDate()-n),_.setHours(0,0,0,0),_};return C.subscribe(n=>{if(n&&n.data.length>0){l(0,t={});const i=new Date,_=e(31,i);n.data.forEach((h,O)=>{h.date>_&&(h.song_id in t?"playlists"in t[h.song_id]&&l(0,t[h.song_id].playlists=[...t[h.song_id].playlists,h.playlist],t):l(0,t[h.song_id]={...h,playlists:[h.playlist]},t))})}}),[t]}class vt extends st{constructor(a){super(),lt(this,a,mt,pt,ot,{})}}function gt(f){let a,l,t,e,n;return e=new vt({}),{c(){a=u("meta"),l=D(),t=u("div"),rt(e.$$.fragment),this.h()},l(i){const _=it("svelte-wxt0nb",document.head);a=p(_,"META",{name:!0,content:!0}),_.forEach(d),l=T(i),t=p(i,"DIV",{class:!0});var h=m(t);ct(e.$$.fragment,h),h.forEach(d),this.h()},h(){document.title="Stats",M(a,"name","description"),M(a,"content","Stats"),M(t,"class","app")},m(i,_){o(document.head,a),U(i,l,_),U(i,t,_),dt(e,t,null),n=!0},p:z,i(i){n||(ht(e.$$.fragment,i),n=!0)},o(i){ft(e.$$.fragment,i),n=!1},d(i){d(a),i&&d(l),i&&d(t),_t(e)}}}function bt(f,a,l){let t,e;return Q(f,x,n=>l(0,t=n)),Q(f,C,n=>l(1,e=n)),ut(async()=>{W(C,e=await Z(0),e),W(x,t=await Z(1),t)}),[]}class Tt extends st{constructor(a){super(),lt(this,a,bt,gt,ot,{})}}export{Tt as default};
