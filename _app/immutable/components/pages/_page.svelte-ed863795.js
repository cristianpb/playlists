import{B as pt,S as mt,i as bt,s as vt,e as Y,b as D,G as K,h as f,H as W,M as X,k as m,a as S,q as T,l as b,m as g,c as A,r as k,N as Et,n as Q,O as ot,F as c,P as gt,Q as it,u as z,R as wt,w as Tt,T as kt,x as yt,y as Dt,f as Nt,t as St,z as At,o as Ht}from"../../chunks/index-55bdb6f8.js";const Ot=s=>{const l=s.split(`
`).map(e=>e.split(";")),t=l.shift();return l.filter(e=>e.length===t.length).map(e=>{let a={};return t.forEach((i,n)=>a[i]=e[n]),{name:a.name,artists:JSON.parse(a.artists.replaceAll("'",'"')),album_name:a.album_name,date:new Date(a.date),song_id:a.song_id,cover_url:a.cover_url,playlist:a.playlist,position:+a.position}})},Pt=async s=>{const t=await(await fetch(s)).text();return Ot(t)};async function rt(s){const t=await(await fetch("https://api.github.com/repos/cristianpb/playlists/commits?sha=data")).json();return await Pt(`https://raw.githubusercontent.com/cristianpb/playlists/${t[s].sha}/data.csv`)}const Z=pt([]),I=pt([]);function ct(s,l,t){const e=s.slice();return e[6]=l[t],e}function ft(s,l,t){const e=s.slice();return e[9]=l[t],e}function _t(s){let l,t,e,a,i,n,_,w,d,N,y,O,B,M,q,P,F,R,U,J,C,u,p,h,V=s[1],v=[];for(let o=0;o<V.length;o+=1)v[o]=ut(ft(s,V,o));let $=s[0],E=[];for(let o=0;o<$.length;o+=1)E[o]=dt(ct(s,$,o));return{c(){l=m("select");for(let o=0;o<v.length;o+=1)v[o].c();t=S(),e=m("div"),a=m("table"),i=m("thead"),n=m("tr"),_=m("th"),w=T("Name"),d=S(),N=m("th"),y=T("Artists"),O=S(),B=m("th"),M=T("Album"),q=S(),P=m("th"),F=T("Date"),R=S(),U=m("th"),J=T("Position"),C=S(),u=m("tbody");for(let o=0;o<E.length;o+=1)E[o].c();this.h()},l(o){l=b(o,"SELECT",{});var H=g(l);for(let G=0;G<v.length;G+=1)v[G].l(H);H.forEach(f),t=A(o),e=b(o,"DIV",{class:!0});var r=g(e);a=b(r,"TABLE",{class:!0});var L=g(a);i=b(L,"THEAD",{});var x=g(i);n=b(x,"TR",{});var j=g(n);_=b(j,"TH",{});var tt=g(_);w=k(tt,"Name"),tt.forEach(f),d=A(j),N=b(j,"TH",{});var et=g(N);y=k(et,"Artists"),et.forEach(f),O=A(j),B=b(j,"TH",{});var lt=g(B);M=k(lt,"Album"),lt.forEach(f),q=A(j),P=b(j,"TH",{});var at=g(P);F=k(at,"Date"),at.forEach(f),R=A(j),U=b(j,"TH",{});var st=g(U);J=k(st,"Position"),st.forEach(f),j.forEach(f),x.forEach(f),C=A(L),u=b(L,"TBODY",{});var nt=g(u);for(let G=0;G<E.length;G+=1)E[G].l(nt);nt.forEach(f),L.forEach(f),r.forEach(f),this.h()},h(){s[2]===void 0&&Et(()=>s[3].call(l)),Q(a,"class","table is-bordered is-striped is-narrow is-hoverable is-fullwidth"),Q(e,"class","table-container")},m(o,H){D(o,l,H);for(let r=0;r<v.length;r+=1)v[r].m(l,null);ot(l,s[2]),D(o,t,H),D(o,e,H),c(e,a),c(a,i),c(i,n),c(n,_),c(_,w),c(n,d),c(n,N),c(N,y),c(n,O),c(n,B),c(B,M),c(n,q),c(n,P),c(P,F),c(n,R),c(n,U),c(U,J),c(a,C),c(a,u);for(let r=0;r<E.length;r+=1)E[r].m(u,null);p||(h=gt(l,"change",s[3]),p=!0)},p(o,H){if(H&2){V=o[1];let r;for(r=0;r<V.length;r+=1){const L=ft(o,V,r);v[r]?v[r].p(L,H):(v[r]=ut(L),v[r].c(),v[r].m(l,null))}for(;r<v.length;r+=1)v[r].d(1);v.length=V.length}if(H&6&&ot(l,o[2]),H&5){$=o[0];let r;for(r=0;r<$.length;r+=1){const L=ct(o,$,r);E[r]?E[r].p(L,H):(E[r]=dt(L),E[r].c(),E[r].m(u,null))}for(;r<E.length;r+=1)E[r].d(1);E.length=$.length}},d(o){o&&f(l),it(v,o),o&&f(t),o&&f(e),it(E,o),p=!1,h()}}}function ut(s){let l,t=s[9]+"",e,a,i;return{c(){l=m("option"),e=T(t),a=S(),this.h()},l(n){l=b(n,"OPTION",{});var _=g(l);e=k(_,t),a=A(_),_.forEach(f),this.h()},h(){l.__value=i=s[9],l.value=l.__value},m(n,_){D(n,l,_),c(l,e),c(l,a)},p(n,_){_&2&&t!==(t=n[9]+"")&&z(e,t),_&2&&i!==(i=n[9])&&(l.__value=i,l.value=l.__value)},d(n){n&&f(l)}}}function ht(s){let l,t,e=s[6].name+"",a,i,n,_=s[6].artists.join(", ")+"",w,d,N,y=s[6].album_name+"",O,B,M,q=s[6].date.toLocaleDateString("en-US")+"",P,F,R,U;function J(p,h){if(p[6].attribute=="+")return Lt;if(p[6].attribute=="-")return Ct;if(p[6].attribute!==0)return Rt}let C=J(s),u=C&&C(s);return{c(){l=m("tr"),t=m("td"),a=T(e),i=S(),n=m("td"),w=T(_),d=S(),N=m("td"),O=T(y),B=S(),M=m("td"),P=T(q),F=S(),R=m("td"),u&&u.c(),U=S()},l(p){l=b(p,"TR",{});var h=g(l);t=b(h,"TD",{});var V=g(t);a=k(V,e),V.forEach(f),i=A(h),n=b(h,"TD",{});var v=g(n);w=k(v,_),v.forEach(f),d=A(h),N=b(h,"TD",{});var $=g(N);O=k($,y),$.forEach(f),B=A(h),M=b(h,"TD",{});var E=g(M);P=k(E,q),E.forEach(f),F=A(h),R=b(h,"TD",{});var o=g(R);u&&u.l(o),o.forEach(f),U=A(h),h.forEach(f)},m(p,h){D(p,l,h),c(l,t),c(t,a),c(l,i),c(l,n),c(n,w),c(l,d),c(l,N),c(N,O),c(l,B),c(l,M),c(M,P),c(l,F),c(l,R),u&&u.m(R,null),c(l,U)},p(p,h){h&1&&e!==(e=p[6].name+"")&&z(a,e),h&1&&_!==(_=p[6].artists.join(", ")+"")&&z(w,_),h&1&&y!==(y=p[6].album_name+"")&&z(O,y),h&1&&q!==(q=p[6].date.toLocaleDateString("en-US")+"")&&z(P,q),C===(C=J(p))&&u?u.p(p,h):(u&&u.d(1),u=C&&C(p),u&&(u.c(),u.m(R,null)))},d(p){p&&f(l),u&&u.d()}}}function Rt(s){let l=s[6].attribute+"",t;return{c(){t=T(l)},l(e){t=k(e,l)},m(e,a){D(e,t,a)},p(e,a){a&1&&l!==(l=e[6].attribute+"")&&z(t,l)},d(e){e&&f(t)}}}function Ct(s){let l,t=s[6].attribute+"",e;return{c(){l=T("Out! "),e=T(t)},l(a){l=k(a,"Out! "),e=k(a,t)},m(a,i){D(a,l,i),D(a,e,i)},p(a,i){i&1&&t!==(t=a[6].attribute+"")&&z(e,t)},d(a){a&&f(l),a&&f(e)}}}function Lt(s){let l,t=s[6].position+"",e;return{c(){l=T("New! "),e=T(t)},l(a){l=k(a,"New! "),e=k(a,t)},m(a,i){D(a,l,i),D(a,e,i)},p(a,i){i&1&&t!==(t=a[6].position+"")&&z(e,t)},d(a){a&&f(l),a&&f(e)}}}function dt(s){let l,t=s[6].playlist===s[2]&&ht(s);return{c(){t&&t.c(),l=Y()},l(e){t&&t.l(e),l=Y()},m(e,a){t&&t.m(e,a),D(e,l,a)},p(e,a){e[6].playlist===e[2]?t?t.p(e,a):(t=ht(e),t.c(),t.m(l.parentNode,l)):t&&(t.d(1),t=null)},d(e){t&&t.d(e),e&&f(l)}}}function jt(s){let l,t=s[0]&&s[1].length>0&&_t(s);return{c(){t&&t.c(),l=Y()},l(e){t&&t.l(e),l=Y()},m(e,a){t&&t.m(e,a),D(e,l,a)},p(e,[a]){e[0]&&e[1].length>0?t?t.p(e,a):(t=_t(e),t.c(),t.m(l.parentNode,l)):t&&(t.d(1),t=null)},i:K,o:K,d(e){t&&t.d(e),e&&f(l)}}}function Bt(s,l,t){let e;W(s,I,w=>t(4,e=w));let a=[],i=[],n;Z.subscribe(w=>{w.forEach((d,N)=>{e.forEach((y,O)=>{d.playlist==y.playlist&&d.song_id===y.song_id&&(w[N].attribute=d.position-y.position,X(I,e[O].attribute=d.position-y.position,e))})}),w.forEach(d=>{"attribute"in d?t(0,a=[...a,d]):t(0,a=[...a,{...d,attribute:"+"}])}),e.forEach(d=>{"attribute"in d||t(0,a=[...a,{...d,attribute:"-"}])}),t(1,i=[...new Set(w.map(d=>d.playlist))])});function _(){n=wt(this),t(2,n),t(1,i)}return[a,i,n,_]}class Mt extends mt{constructor(l){super(),bt(this,l,Bt,jt,vt,{})}}function qt(s){let l,t,e,a,i;return a=new Mt({}),{c(){l=m("meta"),t=S(),e=m("div"),Tt(a.$$.fragment),this.h()},l(n){const _=kt("svelte-pm5yr4",document.head);l=b(_,"META",{name:!0,content:!0}),_.forEach(f),t=A(n),e=b(n,"DIV",{class:!0});var w=g(e);yt(a.$$.fragment,w),w.forEach(f),this.h()},h(){document.title="Playlists",Q(l,"name","description"),Q(l,"content","Playlists app"),Q(e,"class","app")},m(n,_){c(document.head,l),D(n,t,_),D(n,e,_),Dt(a,e,null),i=!0},p:K,i(n){i||(Nt(a.$$.fragment,n),i=!0)},o(n){St(a.$$.fragment,n),i=!1},d(n){f(l),n&&f(t),n&&f(e),At(a)}}}function Ut(s,l,t){let e,a;return W(s,I,i=>t(0,e=i)),W(s,Z,i=>t(1,a=i)),Ht(async()=>{X(Z,a=await rt(0),a),X(I,e=await rt(1),e)}),[]}class $t extends mt{constructor(l){super(),bt(this,l,Ut,qt,vt,{})}}export{$t as default};
