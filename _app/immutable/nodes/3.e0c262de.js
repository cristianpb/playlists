import{S as st,i as lt,s as ot,e as K,b as z,G as U,h as d,k as u,q as S,a as D,l as p,m,r as j,c as y,n as q,F as o,P as nt,u as V,y as rt,R as it,z as ct,A as dt,g as ft,d as ht,B as _t,H as Q,o as ut,T as W}from"../chunks/index.c4dc9443.js";import{d as C,f as Z,o as x}from"../chunks/stores.a47314f6.js";const pt=!1,mt=pt,vt=mt,gt=!0,jt=Object.freeze(Object.defineProperty({__proto__:null,csr:vt,prerender:gt},Symbol.toStringTag,{value:"Module"}));function tt(h,a,l){const t=h.slice();return t[5]=a[l],t}function et(h){let a,l,t,e,n,i,_,f,P,$,g,R,M,b,A,B,H,k,O,E,T=Object.values(h[0]),r=[];for(let s=0;s<T.length;s+=1)r[s]=at(tt(h,T,s));return{c(){a=u("div"),l=u("table"),t=u("thead"),e=u("tr"),n=u("th"),i=S("Name"),_=D(),f=u("th"),P=S("Artists"),$=D(),g=u("th"),R=S("Playlists"),M=D(),b=u("th"),A=S("Date"),B=D(),H=u("th"),k=S("Position"),O=D(),E=u("tbody");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){a=p(s,"DIV",{class:!0});var w=m(a);l=p(w,"TABLE",{class:!0});var c=m(l);t=p(c,"THEAD",{});var L=m(t);e=p(L,"TR",{});var v=m(e);n=p(v,"TH",{});var N=m(n);i=j(N,"Name"),N.forEach(d),_=y(v),f=p(v,"TH",{});var F=m(f);P=j(F,"Artists"),F.forEach(d),$=y(v),g=p(v,"TH",{});var G=m(g);R=j(G,"Playlists"),G.forEach(d),M=y(v),b=p(v,"TH",{});var X=m(b);A=j(X,"Date"),X.forEach(d),B=y(v),H=p(v,"TH",{});var Y=m(H);k=j(Y,"Position"),Y.forEach(d),v.forEach(d),L.forEach(d),O=y(c),E=p(c,"TBODY",{});var J=m(E);for(let I=0;I<r.length;I+=1)r[I].l(J);J.forEach(d),c.forEach(d),w.forEach(d),this.h()},h(){q(l,"class","table is-bordered is-striped is-narrow is-hoverable is-fullwidth"),q(a,"class","table-container")},m(s,w){z(s,a,w),o(a,l),o(l,t),o(t,e),o(e,n),o(n,i),o(e,_),o(e,f),o(f,P),o(e,$),o(e,g),o(g,R),o(e,M),o(e,b),o(b,A),o(e,B),o(e,H),o(H,k),o(l,O),o(l,E);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(E,null)},p(s,w){if(w&1){T=Object.values(s[0]);let c;for(c=0;c<T.length;c+=1){const L=tt(s,T,c);r[c]?r[c].p(L,w):(r[c]=at(L),r[c].c(),r[c].m(E,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=T.length}},d(s){s&&d(a),nt(r,s)}}}function at(h){let a,l,t=h[5].name+"",e,n,i,_=h[5].artists.join(", ")+"",f,P,$,g=h[5].playlists.join(`, 
`)+"",R,M,b,A=h[5].date.toLocaleDateString("en-US")+"",B,H,k,O=h[5].position+"",E,T;return{c(){a=u("tr"),l=u("td"),e=S(t),n=D(),i=u("td"),f=S(_),P=D(),$=u("td"),R=S(g),M=D(),b=u("td"),B=S(A),H=D(),k=u("td"),E=S(O),T=D()},l(r){a=p(r,"TR",{});var s=m(a);l=p(s,"TD",{});var w=m(l);e=j(w,t),w.forEach(d),n=y(s),i=p(s,"TD",{});var c=m(i);f=j(c,_),c.forEach(d),P=y(s),$=p(s,"TD",{});var L=m($);R=j(L,g),L.forEach(d),M=y(s),b=p(s,"TD",{});var v=m(b);B=j(v,A),v.forEach(d),H=y(s),k=p(s,"TD",{});var N=m(k);E=j(N,O),N.forEach(d),T=y(s),s.forEach(d)},m(r,s){z(r,a,s),o(a,l),o(l,e),o(a,n),o(a,i),o(i,f),o(a,P),o(a,$),o($,R),o(a,M),o(a,b),o(b,B),o(a,H),o(a,k),o(k,E),o(a,T)},p(r,s){s&1&&t!==(t=r[5].name+"")&&V(e,t),s&1&&_!==(_=r[5].artists.join(", ")+"")&&V(f,_),s&1&&g!==(g=r[5].playlists.join(`, 
`)+"")&&V(R,g),s&1&&A!==(A=r[5].date.toLocaleDateString("en-US")+"")&&V(B,A),s&1&&O!==(O=r[5].position+"")&&V(E,O)},d(r){r&&d(a)}}}function bt(h){let a=h[0]&&Object.keys(h[0]).length>0,l,t=a&&et(h);return{c(){t&&t.c(),l=K()},l(e){t&&t.l(e),l=K()},m(e,n){t&&t.m(e,n),z(e,l,n)},p(e,[n]){n&1&&(a=e[0]&&Object.keys(e[0]).length>0),a?t?t.p(e,n):(t=et(e),t.c(),t.m(l.parentNode,l)):t&&(t.d(1),t=null)},i:U,o:U,d(e){t&&t.d(e),e&&d(l)}}}function Et(h,a,l){let t={};const e=(n,i=new Date)=>{const _=new Date(i.getTime());return _.setDate(i.getDate()-n),_.setHours(0,0,0,0),_};return C.subscribe(n=>{if(n&&n.data.length>0){l(0,t={});const _=e(31,new Date);n.data.forEach((f,P)=>{f.date>_&&(f.song_id in t?"playlists"in t[f.song_id]&&l(0,t[f.song_id].playlists=[...t[f.song_id].playlists,f.playlist],t):l(0,t[f.song_id]={...f,playlists:[f.playlist]},t))})}}),[t]}class Dt extends st{constructor(a){super(),lt(this,a,Et,bt,ot,{})}}function yt(h){let a,l,t,e,n;return e=new Dt({}),{c(){a=u("meta"),l=D(),t=u("div"),rt(e.$$.fragment),this.h()},l(i){const _=it("svelte-wxt0nb",document.head);a=p(_,"META",{name:!0,content:!0}),_.forEach(d),l=y(i),t=p(i,"DIV",{class:!0});var f=m(t);ct(e.$$.fragment,f),f.forEach(d),this.h()},h(){document.title="Stats",q(a,"name","description"),q(a,"content","Stats"),q(t,"class","app")},m(i,_){o(document.head,a),z(i,l,_),z(i,t,_),dt(e,t,null),n=!0},p:U,i(i){n||(ft(e.$$.fragment,i),n=!0)},o(i){ht(e.$$.fragment,i),n=!1},d(i){d(a),i&&d(l),i&&d(t),_t(e)}}}function Tt(h,a,l){let t,e;return Q(h,x,n=>l(0,t=n)),Q(h,C,n=>l(1,e=n)),ut(async()=>{W(C,e=await Z(0),e),W(x,t=await Z(1),t)}),[]}class $t extends st{constructor(a){super(),lt(this,a,Tt,yt,ot,{})}}export{$t as component,jt as universal};
