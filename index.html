<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>New songs | Playlists dashboard</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-sun-faded.css">
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-sun-faded.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.css">
<link rel="modulepreload" href="./_import/components/tools.js?sha=a6cf6cc415e765985c3090725380e3f1d1ae34254e86bdcac134cbd0d404aa4f">
<link rel="modulepreload" href="./_observablehq/client.js">
<link rel="modulepreload" href="./_observablehq/runtime.js">
<link rel="modulepreload" href="./_observablehq/stdlib.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.js">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6.13/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/binary-search-bounds@2.0.5/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-array@3.2.4/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-axis@3.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-brush@3.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-chord@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-color@3.1.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-contour@4.0.2/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-delaunay@6.0.4/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-dispatch@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-drag@3.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-dsv@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-ease@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-fetch@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-force@3.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-format@3.1.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-geo@3.1.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-hierarchy@3.1.2/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-interpolate@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-path@3.1.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-polygon@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-quadtree@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-random@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-scale-chromatic@3.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-scale@4.0.2/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-selection@3.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-shape@3.2.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-time-format@4.1.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-time@3.1.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-timer@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-transition@3.0.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3-zoom@3.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/d3@7.8.5/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/delaunator@5.0.0/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/htl@0.3.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/internmap@2.0.3/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/interval-tree-1d@1.0.4/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/isoformat@0.2.1/+esm">
<link rel="modulepreload" href="https://cdn.jsdelivr.net/npm/robust-predicates@3.0.2/+esm">
<script type="module">

import {define} from "./_observablehq/client.js";

define({id: "91381f7b", inputs: ["FileAttachment"], outputs: ["mostFrequent","parseDate","BestSongsPlot","BestArtistsPlot","RecentSongAdds","RecentSongsPlot","latestSongs","diffData","bestArtists"], files: [{"name":"./data/latestArtists.csv","mimeType":"text/csv","path":"./_file/data/latestArtists.csv"},{"name":"./data/playlistdiff.csv","mimeType":"text/csv","path":"./_file/data/playlistdiff.csv"},{"name":"./data/bestArtists.csv","mimeType":"text/csv","path":"./_file/data/bestArtists.csv"}], body: async (FileAttachment) => {
const {mostFrequent, parseDate, BestSongsPlot, BestArtistsPlot, RecentSongAdds, RecentSongsPlot} = await import("./_import/components/tools.js?sha=a6cf6cc415e765985c3090725380e3f1d1ae34254e86bdcac134cbd0d404aa4f");
const latestSongs = await FileAttachment("data/latestArtists.csv").csv({typed: true})
const diffData = await FileAttachment("data/playlistdiff.csv").csv().then(data => {
      return data.map(row => {
        row.commit_date = parseDate(new Date(row.commit_date))
        return row
      });
    });
const bestArtists = await FileAttachment("data/bestArtists.csv").csv().then(data => {
      return data.map(row => {
        row.commit_date_str = row.commit_date;
        row.commit_date = new Date(row.commit_date);
        row.name = row.name.toLowerCase();
        row.position = +row.position;
        return row
      });
    });
return {mostFrequent,parseDate,BestSongsPlot,BestArtistsPlot,RecentSongAdds,RecentSongsPlot,latestSongs,diffData,bestArtists};
}});

define({id: "6be40f32", inline: true, inputs: ["RecentSongsPlot","latestSongs","display"], body: async (RecentSongsPlot,latestSongs,display) => {
display(await(
RecentSongsPlot(latestSongs)
))
}});

define({id: "0cd3afd3", inputs: ["diffData"], outputs: ["commit_date_old","commit_date_recent"], body: (diffData) => {
const commit_date_old = Array.from(new Set(diffData.map(i => i.commit_date)))[1];
const commit_date_recent = Array.from(new Set(diffData.map(i => i.commit_date)))[0];
return {commit_date_old,commit_date_recent};
}});

define({id: "9bee6d36", inline: true, inputs: ["commit_date_old","display"], body: async (commit_date_old,display) => {
display(await(
commit_date_old
))
}});

define({id: "a3679416", inline: true, inputs: ["commit_date_recent","display"], body: async (commit_date_recent,display) => {
display(await(
commit_date_recent
))
}});

define({id: "3c7c7c53", inputs: ["bestArtists","view","Inputs"], outputs: ["playlistsNames","playlistChoosen","artistsNames"], body: (bestArtists,view,Inputs) => {
const playlistsNames = bestArtists.map(i => i.playlist)
const playlistChoosen = view(Inputs.select(new Set(playlistsNames), {value: playlistsNames[0], label: "Playlists"}));
const artistsNames = bestArtists.map(i => i.artists)
return {playlistsNames,playlistChoosen,artistsNames};
}});

define({id: "6153a948", inputs: ["RecentSongAdds","diffData","playlistChoosen","commit_date_old","commit_date_recent"], outputs: ["tableRows"], body: (RecentSongAdds,diffData,playlistChoosen,commit_date_old,commit_date_recent) => {
const tableRows = RecentSongAdds(diffData, playlistChoosen, commit_date_old, commit_date_recent)
return {tableRows};
}});

define({id: "61b254b6", inline: true, inputs: ["Inputs","tableRows","display"], body: async (Inputs,tableRows,display) => {
display(await(
Inputs.table(tableRows, {
  columns: ["position", "artists", "name", "album_name", "attribute"],
  align: {"position": "left"},
  format: {
    attribute: (x) => x == "+" ? "New!" : x == "-" ? "ðŸ—‘" : x > 0 ? `â¬†${x}` : x == 0 ? '--' : `â¬‡${Math.abs(x)}`
  }
})
))
}});

define({id: "8241dd1b", inline: true, inputs: ["BestArtistsPlot","bestArtists","playlistChoosen","display"], body: async (BestArtistsPlot,bestArtists,playlistChoosen,display) => {
display(await(
BestArtistsPlot(bestArtists, playlistChoosen)
))
}});

define({id: "06634e09", inputs: ["view","Inputs","mostFrequent","bestArtists","playlistChoosen","artistsNames"], outputs: ["mostPopularArtists"], body: (view,Inputs,mostFrequent,bestArtists,playlistChoosen,artistsNames) => {
const mostPopularArtists = view(Inputs.select(mostFrequent(bestArtists.filter(i => i.playlist == playlistChoosen).map(i => i.artists)).slice(0,10), {value: artistsNames[0], label: "Popular artists"}));
return {mostPopularArtists};
}});

define({id: "3339d464", inline: true, inputs: ["BestSongsPlot","bestArtists","playlistChoosen","mostPopularArtists","display"], body: async (BestSongsPlot,bestArtists,playlistChoosen,mostPopularArtists,display) => {
display(await(
BestSongsPlot(bestArtists, playlistChoosen, mostPopularArtists)
))
}});

define({id: "bd09fb10", inline: true, inputs: ["Inputs","bestArtists","playlistChoosen","mostPopularArtists","display"], body: async (Inputs,bestArtists,playlistChoosen,mostPopularArtists,display) => {
display(await(
Inputs.table(bestArtists
  .filter((row, index) => bestArtists.map(i =>  `${i.song_id}${i.artists}`).indexOf(`${row.song_id}${row.artists}`) === index)
  .filter((row, index) => (row.playlist == playlistChoosen) & (mostPopularArtists.includes(row.artists)))
  , {
  columns: ["artists", "name", "album_name", "date"],
  })
))
}});

</script>
<div id="observablehq-center">
<main id="observablehq-main" class="observablehq">
<h1 id="new-songs" tabindex="-1"><a class="observablehq-header-anchor" href="#new-songs">New songs</a></h1>
<p>Recent songs from the last month.</p>
<div id="cell-91381f7b" class="observablehq observablehq--block"></div>
<div class="grid grid-cols-1" style="grid-auto-rows: 560px;">
  <div class="card">
    <span id="cell-6be40f32" class="observablehq--loading"></span>
  </div>
</div>
<h1 id="playlist-details" tabindex="-1"><a class="observablehq-header-anchor" href="#playlist-details">Playlist details</a></h1>
<div id="cell-0cd3afd3" class="observablehq observablehq--block"></div>
<p>From <span id="cell-9bee6d36" class="observablehq--loading"></span> to <span id="cell-a3679416" class="observablehq--loading"></span> new songs have been added to the playlist.</p>
<div id="cell-3c7c7c53" class="observablehq observablehq--block"></div>
<div id="cell-6153a948" class="observablehq observablehq--block"></div>
<div class="card" style="margin: 1rem 0 2rem 0; padding: 0;">
  <span id="cell-61b254b6" class="observablehq--loading"></span>
</div>
<div class="grid grid-cols-1" style="grid-auto-rows: 560px;">
  <div class="card">
    <span id="cell-8241dd1b" class="observablehq--loading"></span>
  </div>
</div>
<div id="cell-06634e09" class="observablehq observablehq--block"></div>
<div class="grid grid-cols-1" style="grid-auto-rows: 560px;">
  <div class="card">
    <span id="cell-3339d464" class="observablehq--loading"></span>
  </div>
</div>
<div class="card" style="margin: 1rem 0 2rem 0; padding: 0;">
  <span id="cell-bd09fb10" class="observablehq--loading"></span>
</div>
</main>
</div>
